#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Checking code quality before commit..."

# Run type checking
echo "ğŸ“‹ Running TypeScript checks..."
npm run typecheck || { echo "âŒ TypeScript check failed. Please fix the errors before committing."; exit 1; }

# Run linting
echo "ğŸ§¹ Running lint checks..."
npm run lint || { echo "âŒ Lint check failed. Please fix the errors before committing."; exit 1; }

# Format code
echo "âœ¨ Formatting code..."
npm run format || { echo "âŒ Code formatting failed. Please fix the issues before committing."; exit 1; }

# Security audit
echo "ğŸ”’ Running security audit..."
npm run security:check || echo "âš ï¸ Security audit found issues. Review .ark7_hyperlogs/npm-audit-report.json"

echo "âœ… Code checks passed! Committing..."